<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <button class="btn btn-outline-secondary fw-bold rounded-pill" (click)="goToDashboard()">
      <i class="bi bi-arrow-left me-2"></i> Retour au tableau de bord
    </button>
    <div class="position-relative">
      <i class="bi bi-cart3 fs-2" routerLink="/panier"></i>
      <span *ngIf="cartItemCount > 0"
        class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
        {{ cartItemCount }}
        <span class="visually-hidden">articles dans le panier</span>
      </span>
    </div>
  </div>

  <h2 class="text-center mb-4 text-primary fw-bold">Panier</h2>

  <div class="card shadow-lg rounded-4">
    <div class="card-body p-4">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th scope="col">Produit</th>
              <th scope="col">Quantité</th>
              <th scope="col">Prix unitaire</th>
              <th scope="col">Sous-total</th>
              <th scope="col" class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of cartItems">
              <td>{{ item.name }}</td>
              <td>
                <div class="input-group">
                  <button class="btn btn-sm btn-outline-secondary" type="button"
                    (click)="decreaseQuantity(item)">-</button>
                  <input type="number" class="form-control form-control-sm text-center"
                    [(ngModel)]="item.quantity" min="1">
                  <button class="btn btn-sm btn-outline-secondary" type="button"
                    (click)="increaseQuantity(item)">+</button>
                </div>
              </td>
              <td>{{ item.unitPrice }} €</td>
              <td>{{ item.quantity * item.unitPrice }} €</td>
              <td class="text-center">
                <button class="btn btn-sm btn-danger rounded-pill"
                  (click)="removeFromCart(item)">
                  <i class="bi bi-trash me-1"></i> Supprimer
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!--  Affichage du total avec mention "frais de port inclus" -->
      <div class="mt-4">
        <p><strong>Total (frais de port inclus) :</strong> {{ total }} €</p>
      </div>

      <!-- Champ adresse livraison -->
      <div class="form-group mt-4">
        <label for="adresseLivraison" class="form-label fw-bold">Adresse de livraison</label>
        <input type="text" id="adresseLivraison" class="form-control" [(ngModel)]="adresseLivraison"
          placeholder="Entrez votre adresse complète" required>
      </div>

      <div class="text-center mt-4">
        <button class="btn btn-primary rounded-pill btn-lg"
          (click)="Commander()"
          [disabled]="cartItems.length === 0 || !adresseLivraison">
          <i class="bi bi-credit-card me-2"></i> Commander
        </button>
      </div>
    </div>
  </div>
</div>
